---
layout: post
title: 计算机启动时发生了什么
date: 2016-12-1 16:44
category: "O-perating-System"
---

### 前言
开始阅读Linux v0.11的源码，首先需要介绍的就是操作系统启动引导所需要知道的细节。

### 发展
当我们按下计算机的电源之后，BIOS首先会进行加电自检（Power-On Self-Test，POST），判断是否满足运行的条件，如果存在问题，就会发出相应的声音（大家应该遇到过开机时计算机发生错误后，响了“嘀”的一声的情景）。加电自检完成之后，BIOS会将控制权转移给启动程序，这个启动程序怎么来的呢？

先不忙着说这个，先了解一下磁盘相关的信息，磁盘是由一片或多片圆形薄膜叠加而成的，每个面上都有很多同心圆，称为“磁道”，磁道上又分为很多“扇区”（同一个磁道上的扇区分别称为1扇区，2扇区...），一个扇区一般存放有512个字节的数据，为了读取每个面上的数据，都有一个专门的读写磁头（分为0头，1头...），各个面上磁道号相同的组成一个柱面。

第一个存储设备（通常是软驱或磁盘）的第一个扇区（磁盘引导扇区），也就是最前面的512个字节，叫做“主引导记录”（Master boot record， MBR），BIOS在加电自检完成之后，就会将这里的内容加载到内存中绝对地址为 **0x7C00**的地方，然后跳转到这个地方进行执行。

主引导记录由三个部分组成：

> 第1-446字节：调用操作系统的机器码。
> 第447-510字节：分区表（Partition table）。
> 第511-512字节：主引导记录签名（0x55和0xAA）。

这个签名是个魔术数，只有BIOS检测到这个时，它才会认为是有效的引导扇区。

### 结尾
简单讲了下启动时发生的事，主引导记录不会做太多事，它只是会告诉计算机从哪里找操作系统，今天夜深了，我们明天继续。

### 参考
[计算机是如何启动的？-阮一峰的网络日志](http://www.ruanyifeng.com/blog/2013/02/booting.html)
[硬盘MBR详细介绍](http://wenku.baidu.com/view/4ec485d4b9f3f90f76c61bc0.html)